# 外链策略

> 遵循渐进式披露原则：首次接触只需核心信息，深入时再展开细节

## 阈值判断（软硬双阈值）

| 阈值 | 条件 | 动作 |
|------|------|------|
| 软阈值 | 配置文件 >200 行 或 陷阱+模式合计 >12 条 | 建议外链 |
| 硬阈值 | 配置文件 >300 行 | 必须外链 |

## 外链方法

### 方法一：就近原则（优先）

组件强相关陷阱 → 放入组件 README

```
src/components/forms/README.md  ← 表单验证陷阱
src/hooks/README.md             ← hooks 使用模式
```

### 方法二：索引页 + 分文件

通用陷阱使用索引管理：

```
doc/traps/
├── index.md       # 总索引（带 tags）
└── components/    # 可选：按组件细分
    ├── auth.md
    └── forms.md

doc/patterns/
└── index.md       # 成功模式索引
```

## 配置文件保留策略

外链后，配置文件保留摘要 + 指针：

- 保留最近/最重要的 5 条
- 添加指针：`> 完整列表见 doc/traps/index.md`

## 示例

### 外链后的配置文件

```markdown
## 已知陷阱

> 记录标准：(1) 可能再犯 (2) 有通用性 (3) 违反直觉
> 完整列表见 `doc/traps/index.md`

| 问题 | 正确做法 | 来源 |
|------|----------|------|
| 状态未重置 | 组件卸载时清理 | fix: 6f02dcb |
| 类型推断失败 | 显式声明泛型 | refactor: 79a0d6e |
```

### index.md 格式

```markdown
# 已知陷阱索引

| 问题 | 正确做法 | 来源 | 标签 |
|------|----------|------|------|
| 状态未重置 | 组件卸载时清理 | fix: 6f02dcb | hooks |
| 类型推断失败 | 显式声明泛型 | refactor: 79a0d6e | typescript |
| 表单重复提交 | 禁用按钮+防抖 | fix: a1b2c3d | forms |
```
